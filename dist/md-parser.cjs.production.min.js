"use strict";function t(t,r){t.prototype=Object.create(r.prototype),t.prototype.constructor=t,e(t,r)}function e(t,r){return(e=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,r)}function r(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function n(t,s,o){return(n=r()?Reflect.construct:function(t,r,n){var s=[null];s.push.apply(s,r);var o=new(Function.bind.apply(t,s));return n&&e(o,n.prototype),o}).apply(null,arguments)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function o(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return s(t,void 0);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,void 0):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i;Object.defineProperty(exports,"__esModule",{value:!0}),function(t){t[t.END=0]="END",t[t.EMPHASIS=1]="EMPHASIS",t[t.STRONG=2]="STRONG",t[t.STRIKEOUT=3]="STRIKEOUT",t[t.CODE=4]="CODE",t[t.TEXT=5]="TEXT",t[t._EMPHASIS=6]="_EMPHASIS",t[t.__STRONG=7]="__STRONG",t[t.IMG=8]="IMG"}(i||(i={}));var u=function(){function t(t,e){this.name=t,this.src=e}var e=t.prototype;return e.toHtml=function(t){t.push("<img alt='"),t.push(this.name),t.push("' src='"),t.push(this.src),t.push("'>")},e.toMarkdown=function(t){throw t},e.toText=function(t){t.push("")},t}(),h=function(){function t(t,e){this.source="",this.pos=0,this.curToken=i.CODE,this.curStringToken="",this.tags=["**","__","--","*","_","`"],this.imgName="",this.imgSrc="",this.strToToken=new Map([["**",i.STRONG],["*",i.EMPHASIS],["--",i.STRIKEOUT],["`",i.CODE],["_",i._EMPHASIS],["__",i.__STRONG],["![",i.IMG]]),this.curTag="",e&&this.tags.push("!["),this.source=t,this.pos=0}var e=t.prototype;return e.checkTag=function(){for(var t,e=o(this.tags);!(t=e()).done;){var r=t.value;if(this.source.startsWith(r,this.pos))return this.curTag=r,!0}return!1},e.test=function(t){return this.pos<this.source.length&&t===this.source[this.pos]},e.parseImg=function(){for(var t,e,r=this.pos;this.pos<this.source.length&&!this.source.startsWith("](",this.pos);)this.pos++;if(this.pos<this.source.length&&this.source.startsWith("](",this.pos)){for(t=this.pos;this.pos<this.source.length&&!this.source.startsWith(")",this.pos);)this.pos++;if(this.pos<this.source.length&&this.source.startsWith(")",this.pos))return e=this.pos,this.imgName=this.source.substring(r,t),this.imgSrc=this.source.substring(t+2,e),void this.pos++}throw"atata"},e.getImg=function(){return new u(this.imgName,this.imgSrc)},e.nextToken=function(){if(this.pos>=this.source.length)return i.END;if(this.checkTag()){this.curStringToken=this.curTag;var t=this.strToToken.get(this.curTag);return this.curToken=void 0===t?i.CODE:t,this.pos+=this.curTag.length,this.curToken===i.IMG&&this.parseImg(),this.curToken}for(var e=new Array;this.pos<this.source.length&&!this.checkTag();){var r=this.source.charAt(this.pos++);"<"===r?e.push("&lt;"):">"===r?e.push("&gt;"):"&"===r?e.push("&amp;"):"\\"===r&&this.pos<this.source.length&&(this.test("*")||this.test("_"))?e.push(this.source.charAt(this.pos++)):e.push(r)}return this.curToken=i.TEXT,this.curStringToken=e.join(""),this.curToken},e.getStringToken=function(){return this.curStringToken},t}(),c=function(){function t(){this.tr=new h(""),this.curToken=i.CODE,this.curStringToken=""}return t.prototype.nextToken=function(){this.curToken=this.tr.nextToken(),this.curStringToken=this.tr.getStringToken()},t}(),a=function(){function t(t){this.elements=n(Array,t)}var e=t.prototype;return e.toHtml=function(t){t.push("<p>");for(var e,r=o(this.elements);!(e=r()).done;)e.value.toHtml(t);t.push("</p>")},e.toMarkdown=function(t){for(var e,r=o(this.elements);!(e=r()).done;)e.value.toMarkdown(t)},e.toText=function(t){for(var e,r=o(this.elements);!(e=r()).done;)e.value.toText(t)},t}(),p=function(){function t(t,e){this.hLevel=e,this.elements=n(Array,t)}var e=t.prototype;return e.toHtml=function(t){t.push("<h"+this.hLevel+">");for(var e,r=o(this.elements);!(e=r()).done;)e.value.toHtml(t);t.push("</h"+this.hLevel+">")},e.toMarkdown=function(t){throw t},e.toText=function(t){t.push("")},t}(),l=function(){function t(t){this.text=t}var e=t.prototype;return e.toHtml=function(t){t.push(this.text)},e.toMarkdown=function(t){t.push(this.text)},e.toText=function(t){t.push(this.text)},t}(),f=function(){function t(t){this.elements=n(Array,t)}var e=t.prototype;return e.toMarkdownSuper=function(t,e,r){r.push(t);for(var n,s=o(this.elements);!(n=s()).done;)n.value.toMarkdown(r);r.push(e)},e.toHtmlSuper=function(t,e,r){r.push(t);for(var n,s=o(this.elements);!(n=s()).done;)n.value.toHtml(r);r.push(e)},e.toText=function(t){for(var e,r=o(this.elements);!(e=r()).done;)e.value.toText(t)},t}(),T=function(e){function r(t){return e.call(this,t)||this}t(r,e);var n=r.prototype;return n.toHtml=function(t){e.prototype.toHtmlSuper.call(this,"<s>","</s>",t)},n.toMarkdown=function(t){e.prototype.toMarkdownSuper.call(this,"~","~",t)},r}(f),m=function(e){function r(t){return e.call(this,t)||this}t(r,e);var n=r.prototype;return n.toHtml=function(t){e.prototype.toHtmlSuper.call(this,"<strong>","</strong>",t)},n.toMarkdown=function(t){e.prototype.toMarkdownSuper.call(this,"__","__",t)},r}(f),g=function(e){function r(t){return e.call(this,t)||this}t(r,e);var n=r.prototype;return n.toHtml=function(t){e.prototype.toHtmlSuper.call(this,"<em>","</em>",t)},n.toMarkdown=function(t){e.prototype.toMarkdownSuper.call(this,"*","*",t)},r}(f),v=function(e){function r(t){return e.call(this,t)||this}t(r,e);var n=r.prototype;return n.toHtml=function(t){e.prototype.toHtmlSuper.call(this,"<code>","</code>",t)},n.toMarkdown=function(t){e.prototype.toMarkdownSuper.call(this,"`","`",t)},r}(f),S=function(e){function r(t,r,n){var s;return(s=e.call(this)||this).curElem="",s.curLine="",s.headerStarts=["###### ","##### ","#### ","### ","## ","# "],s.hLevel=0,s.thrownError=!1,s.isHeaderRequired=!1,s.isImageRequired=!1,s.isImageRequired=!!n,s.isHeaderRequired=!!r,s.source=t.trim().split("\n"),s}t(r,e);var n=r.prototype;return n.parseToHtml=function(){var t=this.parse(),e=[],r=[],n=[];console.log(e,r,n);for(var s,i=o(t);!(s=i()).done;){var u=s.value;u.toText(n),u.toHtml(e),u.toMarkdown(r)}var h=e.join(""),c=r.join(""),a=n.join("");return console.log(h,c,a),""===a?c:h},n.parse=function(){for(var t=new Array;this.nextElement();)this.isParagraph()?(this.tr=new h(this.curElem,this.isImageRequired),this.nextToken(),t.push(new a(this.parseItems()))):(this.tr=new h(this.curElem.substring(this.hLevel+1),this.isImageRequired),this.nextToken(),t.push(new p(this.parseItems(),this.hLevel)));return t},n.isText=function(t){return t===i.TEXT},n.parseItems=function(){for(var t=new Array;this.curToken!==i.END;)if(this.isText(this.curToken))t.push(new l(this.curStringToken)),this.nextToken();else if(this.curToken===i.IMG)t.push(this.tr.getImg()),this.nextToken();else{var e=this.curToken;this.nextToken(),t.push.apply(t,this.parseItem(e))}return t},n.parseItem=function(t){for(var e=new Array;this.curToken!==i.END&&this.curToken!==t;)if(this.isText(this.curToken))e.push(new l(this.curStringToken)),this.nextToken();else if(this.curToken===i.IMG)e.push(this.tr.getImg()),this.nextToken();else{var r=this.curToken;this.nextToken(),e.push.apply(e,this.parseItem(r))}if(this.curToken===t)return this.nextToken(),this.create(e,t);if(t===i.EMPHASIS||t===i._EMPHASIS){var n=new Array;return n.push(new l(this.tokenToString(t))),n.push.apply(n,e),this.nextToken(),n}return this.thrownError=!0,[]},n.tokenToString=function(t){switch(t){case i.STRIKEOUT:return"--";case i.STRONG:return"**";case i.__STRONG:return"__";case i.EMPHASIS:return"*";case i._EMPHASIS:return"_";case i.CODE:return"`";default:return this.thrownError=!0,""}},n.create=function(t,e){switch(e){case i.STRIKEOUT:return[new T(t)];case i.STRONG:case i.__STRONG:return[new m(t)];case i.EMPHASIS:case i._EMPHASIS:return[new g(t)];case i.CODE:return[new v(t)];default:return this.thrownError=!0,[new v(t)]}},n.skipEmpties=function(){for(this.curLine=this.next();null!==this.curLine&&""===this.curLine;)this.curLine=this.next()},n.nextElement=function(){if(this.skipEmpties(),null===this.curLine)return!1;var t=new Array;for(t.push(this.curLine),this.curLine=this.next();null!==this.curLine&&""!==this.curLine;)t.push("\n"),t.push(this.curLine),this.curLine=this.next();return this.curElem=t.join(""),!0},n.next=function(){var t=0===this.source.length?null:this.source.shift();return void 0!==t?t:null},n.isParagraph=function(){if(this.isHeaderRequired)for(var t,e=o(this.headerStarts);!(t=e()).done;){var r=t.value;if(this.curElem.startsWith(r))return this.hLevel=r.length-1,!1}return!0},r}(c);exports.BlockMarkableItem=f,exports.Code=v,exports.Emphasis=g,exports.Header=p,exports.Image=u,exports.MdParser=S,exports.Paragraph=a,exports.Strikeout=T,exports.Strong=m,exports.Text=l;
//# sourceMappingURL=md-parser.cjs.production.min.js.map
